<!DOCTYPE html>
<html>

<head>
    <title>Photo Capture and Upload</title>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <link rel="stylesheet" type="text/css" href="bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="semantic/semantic.min.css">
    <link rel="stylesheet" type="text/css" href="fontawesome/css/fontawesome.min.css">
    <link rel="stylesheet" type="text/css" href="fontawesome/css/solid.min.css">
    <script type="text/javascript" src="jquery/jquery.3.5.1.min.js"></script>
    <script type="text/javascript" src="semantic/semantic.min.js"></script>
    <script type="text/javascript" src="fontawesome/js/fontawesome.min.js"></script>
    <style type="text/css">
        .verticalcenter {
            padding: 15px;
            position: absolute;
            top: 50%;
            left: 50%;
            width: 100%;
            -ms-transform: translateX(-50%) translateY(-50%);
            -webkit-transform: translate(-50%, -50%);
            transform: translate(-50%, -50%);
        }
    </style>
</head>

<body onload="onLoad()">
    <div class="container verticalcenter">
        <div class="ui centered card" id="scan">
            <div class="image">
                <img src="img/barcodescanner.png" />
            </div>
        </div>

        <div class="field">
            <div class="ui fluid input">
                <input type="text" id="txttagno">
            </div>
        </div>
    </div>
    <div class="ui active inverted page dimmer">
        <div class="ui large text loader">Loading</div>
    </div>
    <input type="hidden" id="hempid" />
</body>

</html>
<script type="text/javascript" src="jquery/phonegap-1.1.0.js"></script>
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript">
    var deviceReady = false;
    var qsParm = new Array();
    var imageUrl = '';

    function onLoad() {
        document.addEventListener("deviceready", onDeviceReady, false);
    }

    function onDeviceReady() {
        document.addEventListener("backbutton", onBackKeyDown, false);
    }

    function onBackKeyDown() {}

    function qs() {
        //debugger;
        var query = window.location.search.substring(1);
        var parms = query.split('&');
        for (var i = 0; i < parms.length; i++) {
            var pos = parms[i].indexOf('=');
            if (pos > 0) {
                var key = parms[i].substring(0, pos);
                var val = parms[i].substring(pos + 1);
                qsParm[key] = val;
            }
        }
        if (parms.length > 0) {
            $("#hempid").val(atob(qsParm["empid"]));
            return true;
        } else {
            window.location.href = 'index.html';
            return false;
        }
    }

    function isPhoneGap() {
        return (window.cordova || window.PhoneGap || window.phonegap) &&
            /^file:\/{3}[^\/]/i.test(window.location.href) &&
            /ios|iphone|ipod|ipad|android/i.test(navigator.userAgent);
    }

    $(document).ready(function () {
        $(".dimmer").hide();
        // qs();
        $("#scan").click(function () {
            scan();
        });
    });

    function init() {
        document.addEventListener("deviceready", function () {
            deviceReady = true;
        }, false);
        window.setTimeout(function () {
            if (!deviceReady) {
                alert("Error: Camera not initialised.");
            }
        }, 2000);
    }

    function scan() {
        cordova.plugins.barcodeScanner.scan(
            function (result) {
                if (!result.cancelled) {
                    $("#txttagno").val(result.text);
                }
            },
            function (error) {
                alert("Scanning failed: " + error);
            }
        );
        $(".dimmer").hide();
    }
</script>